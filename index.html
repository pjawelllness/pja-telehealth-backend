<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PJA Wellness Management - Telehealth Services</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: #f8f9fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e1e8ed;
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.04);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #0066cc 0%, #004999 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
        }

        .logo-text h1 {
            font-size: 20px;
            color: #1a1a1a;
            font-weight: 600;
        }

        .logo-text p {
            font-size: 13px;
            color: #6c757d;
        }

        .trust-badges {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .trust-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: #f0f7ff;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            color: #0066cc;
            border: 1px solid #d1e7ff;
        }

        .trust-badge-icon {
            font-size: 14px;
        }

        .container {
            max-width: 900px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .section-header h2 {
            font-size: 32px;
            color: #1a1a1a;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .section-header p {
            font-size: 16px;
            color: #6c757d;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            gap: 8px;
        }

        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #6c757d;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .step.active {
            background: #0066cc;
            color: white;
            transform: scale(1.1);
        }

        .step.completed {
            background: #28a745;
            color: white;
        }

        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .service-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #e1e8ed;
            position: relative;
            overflow: hidden;
        }

        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0066cc 0%, #004999 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .service-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,102,204,0.12);
            border-color: #0066cc;
        }

        .service-card:hover::before {
            opacity: 1;
        }

        .service-card.selected {
            border-color: #0066cc;
            background: #f0f7ff;
        }

        .service-card.selected::before {
            opacity: 1;
        }

        .hsa-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .service-card h3 {
            font-size: 18px;
            color: #1a1a1a;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .service-price {
            font-size: 28px;
            color: #0066cc;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .service-duration {
            color: #6c757d;
            font-size: 14px;
            margin-bottom: 16px;
        }

        .service-description {
            color: #495057;
            font-size: 14px;
            line-height: 1.6;
        }

        .form-section {
            background: white;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 24px;
            border: 1px solid #e1e8ed;
        }

        .form-section h3 {
            font-size: 20px;
            color: #1a1a1a;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #495057;
            font-weight: 500;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #ced4da;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #0066cc;
            box-shadow: 0 0 0 3px rgba(0,102,204,0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .consent-box {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
            max-height: 400px;
            overflow-y: auto;
        }

        .consent-box h4 {
            color: #1a1a1a;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 600;
        }

        .consent-box p {
            margin-bottom: 12px;
            font-size: 14px;
            line-height: 1.8;
            color: #495057;
        }

        .consent-box ul {
            margin-left: 20px;
            margin-bottom: 12px;
        }

        .consent-box li {
            margin-bottom: 8px;
            font-size: 14px;
            line-height: 1.6;
            color: #495057;
        }

        .checkbox-group {
            display: flex;
            align-items: start;
            gap: 12px;
            padding: 16px;
            background: #fff;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .checkbox-group:hover {
            border-color: #0066cc;
            background: #f0f7ff;
        }

        .checkbox-group input[type="checkbox"] {
            width: 24px;
            height: 24px;
            margin-top: 2px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .checkbox-group label {
            flex: 1;
            margin: 0;
            cursor: pointer;
            font-size: 14px;
            line-height: 1.6;
            font-weight: 500;
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #0066cc 0%, #004999 100%);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,102,204,0.3);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: white;
            color: #0066cc;
            border: 2px solid #0066cc;
        }

        .btn-secondary:hover {
            background: #f0f7ff;
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .time-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        .time-slot {
            padding: 12px;
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .time-slot:hover {
            border-color: #0066cc;
            background: #f0f7ff;
        }

        .time-slot.selected {
            background: #0066cc;
            color: white;
            border-color: #0066cc;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f0f7ff;
            border-top-color: #0066cc;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .success-screen {
            text-align: center;
            padding: 60px 20px;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 40px;
        }

        .success-screen h2 {
            font-size: 28px;
            color: #1a1a1a;
            margin-bottom: 12px;
        }

        .success-screen p {
            font-size: 16px;
            color: #6c757d;
            margin-bottom: 32px;
        }

        .provider-toggle {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: linear-gradient(135deg, #0066cc 0%, #004999 100%);
            color: white;
            padding: 16px 24px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0,102,204,0.3);
            z-index: 1000;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .provider-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,102,204,0.4);
        }

        .provider-portal {
            background: white;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 40px;
            border: 1px solid #e1e8ed;
        }

        .provider-login {
            max-width: 400px;
            margin: 0 auto;
        }

        .booking-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            border-left: 4px solid #0066cc;
        }

        .booking-card h4 {
            color: #1a1a1a;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .booking-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 12px;
        }

        .booking-info-item {
            font-size: 14px;
        }

        .booking-info-label {
            font-weight: 600;
            color: #495057;
        }

        .booking-info-value {
            color: #6c757d;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-accepted {
            background: #d4edda;
            color: #155724;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .trust-badges {
                flex-direction: column;
                align-items: flex-start;
            }

            .header-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">PJA</div>
                <div class="logo-text">
                    <h1>PJA Wellness Management</h1>
                    <p>Board Certified Holistic Health Care</p>
                </div>
            </div>
            <div class="trust-badges">
                <div class="trust-badge">
                    <span class="trust-badge-icon">üîí</span>
                    <span>HIPAA Compliant</span>
                </div>
                <div class="trust-badge">
                    <span class="trust-badge-icon">‚úì</span>
                    <span>Board Certified</span>
                </div>
                <div class="trust-badge">
                    <span class="trust-badge-icon">üí≥</span>
                    <span>HSA/FSA Accepted</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Step Indicator -->
        <div class="step-indicator">
            <div class="step active" id="step1">1</div>
            <div class="step" id="step2">2</div>
            <div class="step" id="step3">3</div>
            <div class="step" id="step4">4</div>
            <div class="step" id="step5">5</div>
            <div class="step" id="step6">6</div>
        </div>

        <!-- Step 1: Service Selection -->
        <div id="serviceSelection" class="step-content">
            <div class="section-header">
                <h2>Choose Your Service</h2>
                <p>Select the telehealth consultation that best fits your needs</p>
            </div>

            <div class="service-grid">
                <div class="service-card" onclick="selectService('Comprehensive Wellness Visit', 99, 45)">
                    <div class="hsa-badge">
                        <span>‚úì</span>
                        <span>HSA/FSA Accepted</span>
                    </div>
                    <h3>Comprehensive Wellness Visit</h3>
                    <div class="service-price">$99</div>
                    <div class="service-duration">45 minutes</div>
                    <p class="service-description">Complete health assessment with personalized wellness plan. Ideal for new patients or comprehensive health reviews.</p>
                </div>

                <div class="service-card" onclick="selectService('Follow-up Consultation', 75, 30)">
                    <div class="hsa-badge">
                        <span>‚úì</span>
                        <span>HSA/FSA Accepted</span>
                    </div>
                    <h3>Follow-up Consultation</h3>
                    <div class="service-price">$75</div>
                    <div class="service-duration">30 minutes</div>
                    <p class="service-description">Progress check-in and treatment plan adjustments. Perfect for ongoing care and monitoring.</p>
                </div>

                <div class="service-card" onclick="selectService('Acute Care Visit', 50, 20)">
                    <div class="hsa-badge">
                        <span>‚úì</span>
                        <span>HSA/FSA Accepted</span>
                    </div>
                    <h3>Acute Care Visit</h3>
                    <div class="service-price">$50</div>
                    <div class="service-duration">20 minutes</div>
                    <p class="service-description">Quick consultation for immediate concerns and acute symptoms. Fast, focused care when you need it.</p>
                </div>
            </div>
        </div>

        <!-- Step 2: Personal Information -->
        <div id="personalInfo" class="step-content hidden">
            <div class="section-header">
                <h2>Personal Information</h2>
                <p>Please provide your contact details</p>
            </div>

            <div class="form-section">
                <div class="form-row">
                    <div class="form-group">
                        <label>First Name *</label>
                        <input type="text" id="firstName" required>
                    </div>
                    <div class="form-group">
                        <label>Last Name *</label>
                        <input type="text" id="lastName" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Email Address *</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label>Phone Number *</label>
                        <input type="tel" id="phone" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>Date of Birth *</label>
                    <input type="date" id="dob" required>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep('serviceSelection')">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="savePersonalInfo()">Continue ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 3: Health Information -->
        <div id="healthInfo" class="step-content hidden">
            <div class="section-header">
                <h2>Health Information</h2>
                <p>Help us understand your health needs</p>
            </div>

            <div class="form-section">
                <div class="form-group">
                    <label>Primary Concern *</label>
                    <input type="text" id="primaryConcern" placeholder="What brings you here today?" required>
                </div>

                <div class="form-group">
                    <label>Current Symptoms *</label>
                    <textarea id="symptoms" placeholder="Describe your symptoms in detail..." required></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>How long have you had these symptoms? *</label>
                        <select id="duration" required>
                            <option value="">Select duration</option>
                            <option value="less-than-week">Less than a week</option>
                            <option value="1-2-weeks">1-2 weeks</option>
                            <option value="2-4-weeks">2-4 weeks</option>
                            <option value="1-3-months">1-3 months</option>
                            <option value="more-than-3-months">More than 3 months</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Symptom Severity *</label>
                        <select id="severity" required>
                            <option value="">Select severity</option>
                            <option value="mild">Mild</option>
                            <option value="moderate">Moderate</option>
                            <option value="severe">Severe</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Current Medications</label>
                    <textarea id="medications" placeholder="List any medications you're currently taking (or write 'None')"></textarea>
                </div>

                <div class="form-group">
                    <label>Allergies</label>
                    <textarea id="allergies" placeholder="List any allergies (or write 'None')"></textarea>
                </div>

                <div class="form-group">
                    <label>Relevant Medical History</label>
                    <textarea id="medicalHistory" placeholder="Any relevant medical conditions or past treatments..."></textarea>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep('personalInfo')">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="saveHealthInfo()">Continue ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 4: Consent Forms -->
        <div id="consentForms" class="step-content hidden">
            <div class="section-header">
                <h2>Consent & Authorization Forms</h2>
                <p>Please review and agree to all required legal documents</p>
            </div>

            <div class="form-section">
                <!-- HIPAA Authorization -->
                <div class="consent-box">
                    <h4>1. HIPAA AUTHORIZATION FOR RELEASE OF HEALTH INFORMATION</h4>
                    <p><strong>Effective Date:</strong> Upon Signature Below</p>
                    
                    <p>I hereby authorize PJA Wellness Management LLC ("Provider") and its healthcare providers, including Patrick Smith, Board Certified Holistic Health Practitioner, to use and disclose my protected health information (PHI) as described below.</p>
                    
                    <p><strong>Information to be Used or Disclosed:</strong></p>
                    <ul>
                        <li>Complete medical history and physical examination findings</li>
                        <li>Laboratory test results, diagnostic imaging, and other clinical findings</li>
                        <li>Current and past treatment plans, medications, and therapies</li>
                        <li>Mental health and substance abuse treatment records (if applicable)</li>
                        <li>Billing and insurance information</li>
                    </ul>

                    <p><strong>Purpose of Use and Disclosure:</strong> This information will be used for:</p>
                    <ul>
                        <li>Treatment: Providing, coordinating, and managing healthcare services</li>
                        <li>Payment: Billing activities and payment processing</li>
                        <li>Healthcare Operations: Quality assessment, training, and business management</li>
                    </ul>

                    <p><strong>Your Rights:</strong></p>
                    <ul>
                        <li>You have the right to revoke this authorization at any time by submitting a written request</li>
                        <li>Revocation will not affect information already disclosed</li>
                        <li>You have the right to refuse to sign this authorization</li>
                        <li>Information disclosed may be subject to re-disclosure and no longer protected</li>
                    </ul>

                    <p><strong>Expiration:</strong> This authorization expires one year from the date of signature, or upon completion of treatment, whichever occurs first.</p>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="hipaaConsent" required>
                    <label for="hipaaConsent">
                        <strong>I have read and understand the HIPAA Authorization above. I authorize the use and disclosure of my protected health information as described.</strong>
                    </label>
                </div>

                <!-- Telehealth Informed Consent -->
                <div class="consent-box">
                    <h4>2. TELEHEALTH INFORMED CONSENT & AGREEMENT</h4>
                    
                    <p><strong>Definition:</strong> Telehealth involves the use of electronic communications and information technologies to provide healthcare services when the patient and provider are in different locations.</p>

                    <p><strong>Benefits of Telehealth:</strong></p>
                    <ul>
                        <li>Improved access to healthcare without geographic barriers</li>
                        <li>More efficient medical evaluation and management</li>
                        <li>Reduced exposure to contagious illnesses</li>
                        <li>Convenience and flexibility in scheduling</li>
                    </ul>

                    <p><strong>Potential Risks and Limitations:</strong></p>
                    <ul>
                        <li>Technical difficulties may interrupt or delay the consultation</li>
                        <li>Information transmission may be subject to unauthorized access despite security measures</li>
                        <li>Physical examination limitations may require in-person follow-up</li>
                        <li>In rare cases, telehealth may not provide the same level of care as in-person visits</li>
                    </ul>

                    <p><strong>Emergency Situations:</strong> Telehealth is NOT appropriate for emergency situations. If you experience a medical emergency, call 911 or go to the nearest emergency room immediately.</p>

                    <p><strong>Right to Discontinue:</strong> You have the right to discontinue the telehealth visit at any time and request an in-person appointment instead.</p>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="telehealthConsent" required>
                    <label for="telehealthConsent">
                        <strong>I have read and understand the Telehealth Informed Consent. I understand the benefits, risks, and limitations of telehealth services. I consent to participate in a telehealth consultation.</strong>
                    </label>
                </div>

                <!-- Treatment Informed Consent -->
                <div class="consent-box">
                    <h4>3. INFORMED CONSENT FOR TREATMENT</h4>
                    
                    <p>I consent to holistic healthcare treatment provided by Patrick Smith, Board Certified Holistic Health Practitioner, and other licensed providers at PJA Wellness Management LLC.</p>

                    <p><strong>I understand that:</strong></p>
                    <ul>
                        <li>A holistic health approach focuses on the whole person - physical, mental, emotional, and spiritual wellbeing</li>
                        <li>Treatment may include nutritional counseling, lifestyle recommendations, supplements, and other complementary therapies</li>
                        <li>Results vary by individual and are not guaranteed</li>
                        <li>I am responsible for following recommended treatment plans and reporting any concerns</li>
                    </ul>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="informedConsent" required>
                    <label for="informedConsent">
                        <strong>I have read and understand the Informed Consent for Treatment. I consent to receive holistic healthcare treatment as recommended by my provider.</strong>
                    </label>
                </div>

                <!-- Privacy Notice -->
                <div class="consent-box">
                    <h4>4. ACKNOWLEDGMENT OF RECEIPT OF PRIVACY NOTICE</h4>
                    
                    <p>I acknowledge that I have been provided with a copy of PJA Wellness Management LLC's Notice of Privacy Practices, which describes how my medical information may be used and disclosed, and how I can access this information.</p>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="privacyNotice" required>
                    <label for="privacyNotice">
                        <strong>I acknowledge receipt of the Notice of Privacy Practices and understand my rights regarding my protected health information.</strong>
                    </label>
                </div>

                <!-- Electronic Signature -->
                <div class="form-group" style="margin-top: 32px;">
                    <label><strong>Electronic Signature *</strong></label>
                    <p style="font-size: 13px; color: #6c757d; margin-bottom: 12px;">
                        By typing your full legal name below, you are providing your electronic signature and agreeing that it has the same legal effect as a handwritten signature.
                    </p>
                    <input type="text" id="signature" placeholder="Type your full legal name" required>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep('healthInfo')">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="saveConsent()">I Agree - Continue ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 5: Schedule Appointment -->
        <div id="scheduleAppointment" class="step-content hidden">
            <div class="section-header">
                <h2>Schedule Your Appointment</h2>
                <p>Select a convenient time for your consultation with Patrick Smith</p>
            </div>

            <div class="form-section">
                <div class="form-group">
                    <label>Select Date *</label>
                    <input type="date" id="appointmentDate" onchange="loadAvailability()">
                </div>

                <div id="errorMessage"></div>
                <div id="timeSlots"></div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep('consentForms')">‚Üê Back</button>
                    <button class="btn btn-primary" id="confirmBookingBtn" disabled onclick="confirmBooking()">Confirm Booking ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 6: Loading/Success -->
        <div id="loadingScreen" class="step-content hidden">
            <div class="loading">
                <div class="loading-spinner"></div>
                <h2>Processing Your Booking...</h2>
                <p>Please wait while we confirm your appointment with Patrick Smith</p>
            </div>
        </div>

        <div id="successScreen" class="step-content hidden">
            <div class="success-screen">
                <div class="success-icon">‚úì</div>
                <h2>Appointment Confirmed!</h2>
                <p>Your appointment with Patrick Smith has been successfully booked. You will receive a confirmation email shortly with appointment details and a video call link.</p>
                <button class="btn btn-primary" onclick="location.reload()">Book Another Appointment</button>
            </div>
        </div>
    </div>

    <!-- Provider Portal Toggle -->
    <div class="provider-toggle" onclick="showProviderLogin()">
        <span>üë®‚Äç‚öïÔ∏è</span>
        <span>Provider Portal</span>
    </div>

    <!-- Provider Portal Login -->
    <div id="providerLogin" class="provider-portal container hidden">
        <div class="section-header">
            <h2>üîí Provider Portal Access</h2>
            <p>Secure login required</p>
        </div>

        <div class="provider-login">
            <div class="form-section">
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="providerPassword" placeholder="Enter provider password" onkeypress="handleLoginKeypress(event)">
                </div>
                <div id="loginError" class="error-message hidden">
                    Incorrect password. Please try again.
                </div>
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="closeProviderLogin()">Cancel</button>
                    <button class="btn btn-primary" onclick="providerLogin()">Login</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Provider Portal -->
    <div id="providerPortal" class="provider-portal container hidden">
        <div class="section-header">
            <h2>Provider Portal</h2>
            <p>View all upcoming appointments and patient information</p>
        </div>

        <button class="btn btn-secondary" onclick="logoutProvider()" style="margin-bottom: 20px;">‚Üê Logout</button>

        <div id="bookingsList"></div>
    </div>

    <script>
        // Global state
        let bookingData = {
            selectedService: null,
            selectedPrice: null,
            selectedDuration: null,
            customerInfo: {},
            healthInfo: {},
            consent: {},
            selectedTime: null
        };

        let providerToken = null;

        const SERVICE_IDS = {
            'Comprehensive Wellness Visit': 'EOS5TK4VKO6YGM4TYUFMXO2W',
            'Follow-up Consultation': 'KOGODBCXVOKARIL3YZ5DVSKS',
            'Acute Care Visit': '45HRDI4XGITSL4SYOKJKYNK4'
        };

        // Service Selection
        function selectService(name, price, duration) {
            bookingData.selectedService = name;
            bookingData.selectedPrice = price;
            bookingData.selectedDuration = duration;
            
            document.querySelectorAll('.service-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            setTimeout(() => {
                goToStep('personalInfo');
                updateSteps(2);
            }, 300);
        }

        // Personal Info
        function savePersonalInfo() {
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const dob = document.getElementById('dob').value;

            if (!firstName || !lastName || !email || !phone || !dob) {
                alert('Please fill in all required fields');
                return;
            }

            bookingData.customerInfo = { firstName, lastName, email, phone, dob };
            goToStep('healthInfo');
            updateSteps(3);
        }

        // Health Info
        function saveHealthInfo() {
            const primaryConcern = document.getElementById('primaryConcern').value;
            const symptoms = document.getElementById('symptoms').value;
            const duration = document.getElementById('duration').value;
            const severity = document.getElementById('severity').value;
            const medications = document.getElementById('medications').value || 'None';
            const allergies = document.getElementById('allergies').value || 'None';
            const medicalHistory = document.getElementById('medicalHistory').value || 'None provided';

            if (!primaryConcern || !symptoms || !duration || !severity) {
                alert('Please fill in all required fields');
                return;
            }

            bookingData.healthInfo = {
                primaryConcern,
                symptoms,
                duration,
                severity,
                medications,
                allergies,
                medicalHistory
            };

            goToStep('consentForms');
            updateSteps(4);
        }

        // Consent
        function saveConsent() {
            const hipaaConsent = document.getElementById('hipaaConsent').checked;
            const telehealthConsent = document.getElementById('telehealthConsent').checked;
            const informedConsent = document.getElementById('informedConsent').checked;
            const privacyNotice = document.getElementById('privacyNotice').checked;
            const signature = document.getElementById('signature').value;

            if (!hipaaConsent || !telehealthConsent || !informedConsent || !privacyNotice || !signature) {
                alert('Please read and agree to all consent forms and provide your electronic signature');
                return;
            }

            bookingData.consent = {
                hipaaConsent,
                telehealthConsent,
                informedConsent,
                privacyNotice,
                signature,
                signatureDate: new Date().toISOString(),
                ipAddress: 'Client-side IP not available'
            };

            goToStep('scheduleAppointment');
            updateSteps(5);
            
            // Set minimum date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('appointmentDate').setAttribute('min', today);
        }

        // Load Availability
        async function loadAvailability() {
            const date = document.getElementById('appointmentDate').value;
            if (!date) return;

            const timeSlotsContainer = document.getElementById('timeSlots');
            const errorMessageContainer = document.getElementById('errorMessage');
            
            errorMessageContainer.innerHTML = '';
            timeSlotsContainer.innerHTML = '<div class="loading"><div class="loading-spinner"></div><p>Loading available times...</p></div>';

            try {
                const serviceId = SERVICE_IDS[bookingData.selectedService];
                console.log('Requesting availability for:', { serviceId, date });

                const response = await fetch('/api/availability', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ serviceId, date })
                });

                const data = await response.json();
                console.log('Availability response:', data);
                
                if (!response.ok) {
                    throw new Error(data.details || data.error || 'Failed to load availability');
                }

                if (data.availabilities && data.availabilities.length > 0) {
                    displayTimeSlots(data.availabilities);
                } else {
                    timeSlotsContainer.innerHTML = '';
                    errorMessageContainer.innerHTML = `
                        <div class="error-message">
                            <strong>No available times for this date.</strong><br>
                            Patrick Smith is fully booked or has no availability hours set for this day. 
                            Please try another date.
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading availability:', error);
                timeSlotsContainer.innerHTML = '';
                errorMessageContainer.innerHTML = `
                    <div class="error-message">
                        <strong>Error loading availability:</strong> ${error.message}<br>
                        Please try again or contact support.
                    </div>
                `;
            }
        }

        function displayTimeSlots(slots) {
            const container = document.getElementById('timeSlots');
            
            if (slots.length === 0) {
                container.innerHTML = '<p style="text-align:center;color:#6c757d;">No available times for this date.</p>';
                return;
            }

            const grid = document.createElement('div');
            grid.className = 'time-grid';

            slots.forEach(slot => {
                const time = new Date(slot.startAt);
                const timeStr = time.toLocaleTimeString('en-US', { 
                    hour: 'numeric', 
                    minute: '2-digit',
                    hour12: true 
                });

                const button = document.createElement('div');
                button.className = 'time-slot';
                button.textContent = timeStr;
                button.onclick = () => selectTime(slot.startAt, button);
                grid.appendChild(button);
            });

            container.innerHTML = '';
            container.appendChild(grid);
        }

        function selectTime(time, element) {
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });
            element.classList.add('selected');
            bookingData.selectedTime = time;
            document.getElementById('confirmBookingBtn').disabled = false;
        }

        // Confirm Booking
        async function confirmBooking() {
            if (!bookingData.selectedTime) {
                alert('Please select a time slot');
                return;
            }

            goToStep('loadingScreen');
            updateSteps(6);

            try {
                console.log('Creating booking with data:', bookingData);

                const response = await fetch('/api/booking', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(bookingData)
                });

                const result = await response.json();
                console.log('Booking response:', result);

                if (result.success) {
                    goToStep('successScreen');
                } else {
                    alert('Booking failed: ' + (result.details || result.error));
                    goToStep('scheduleAppointment');
                    updateSteps(5);
                }
            } catch (error) {
                console.error('Booking error:', error);
                alert('An error occurred while creating your booking: ' + error.message);
                goToStep('scheduleAppointment');
                updateSteps(5);
            }
        }

        // Provider Portal Login
        function showProviderLogin() {
            document.getElementById('providerLogin').classList.remove('hidden');
            document.querySelector('.container').style.display = 'none';
            document.getElementById('providerPassword').focus();
        }

        function closeProviderLogin() {
            document.getElementById('providerLogin').classList.add('hidden');
            document.querySelector('.container').style.display = 'block';
            document.getElementById('providerPassword').value = '';
            document.getElementById('loginError').classList.add('hidden');
        }

        function handleLoginKeypress(event) {
            if (event.key === 'Enter') {
                providerLogin();
            }
        }

        async function providerLogin() {
            const password = document.getElementById('providerPassword').value;
            const errorDiv = document.getElementById('loginError');

            if (!password) {
                errorDiv.textContent = 'Please enter a password';
                errorDiv.classList.remove('hidden');
                return;
            }

            try {
                const response = await fetch('/api/provider/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password })
                });

                const result = await response.json();

                if (result.success) {
                    providerToken = result.token;
                    document.getElementById('providerLogin').classList.add('hidden');
                    document.getElementById('providerPortal').classList.remove('hidden');
                    loadBookings();
                } else {
                    errorDiv.textContent = result.message || 'Incorrect password';
                    errorDiv.classList.remove('hidden');
                    document.getElementById('providerPassword').value = '';
                    document.getElementById('providerPassword').focus();
                }
            } catch (error) {
                console.error('Login error:', error);
                errorDiv.textContent = 'Error connecting to server';
                errorDiv.classList.remove('hidden');
            }
        }

        function logoutProvider() {
            providerToken = null;
            document.getElementById('providerPortal').classList.add('hidden');
            document.querySelector('.container').style.display = 'block';
            document.getElementById('providerPassword').value = '';
            document.getElementById('loginError').classList.add('hidden');
        }

        async function loadBookings() {
            const container = document.getElementById('bookingsList');
            container.innerHTML = '<div class="loading"><div class="loading-spinner"></div><p>Loading appointments...</p></div>';

            try {
                const response = await fetch('/api/bookings', {
                    headers: {
                        'Authorization': `Bearer ${providerToken}`
                    }
                });

                if (!response.ok) {
                    throw new Error('Unauthorized');
                }

                const data = await response.json();

                if (data.bookings && data.bookings.length > 0) {
                    displayBookings(data.bookings);
                } else {
                    container.innerHTML = '<p style="text-align:center;color:#6c757d;">No upcoming appointments</p>';
                }
            } catch (error) {
                console.error('Error loading bookings:', error);
                container.innerHTML = '<p style="text-align:center;color:#dc3545;">Error loading appointments. Please log in again.</p>';
                setTimeout(logoutProvider, 2000);
            }
        }

        function displayBookings(bookings) {
            const container = document.getElementById('bookingsList');
            container.innerHTML = '';

            bookings.forEach(booking => {
                const card = document.createElement('div');
                card.className = 'booking-card';

                const customer = booking.customerDetails;
                const startTime = new Date(booking.startAt);
                const serviceName = Object.keys(SERVICE_IDS).find(key => 
                    booking.appointmentSegments?.[0]?.serviceVariationId === SERVICE_IDS[key]
                );

                card.innerHTML = `
                    <h4>${customer?.givenName} ${customer?.familyName}</h4>
                    <span class="status-badge ${booking.status === 'ACCEPTED' ? 'status-accepted' : 'status-pending'}">
                        ${booking.status || 'PENDING'}
                    </span>
                    <div class="booking-info">
                        <div class="booking-info-item">
                            <div class="booking-info-label">Service:</div>
                            <div class="booking-info-value">${serviceName || 'Unknown'}</div>
                        </div>
                        <div class="booking-info-item">
                            <div class="booking-info-label">Date & Time:</div>
                            <div class="booking-info-value">${startTime.toLocaleString()}</div>
                        </div>
                        <div class="booking-info-item">
                            <div class="booking-info-label">Email:</div>
                            <div class="booking-info-value">${customer?.emailAddress || 'N/A'}</div>
                        </div>
                        <div class="booking-info-item">
                            <div class="booking-info-label">Phone:</div>
                            <div class="booking-info-value">${customer?.phoneNumber || 'N/A'}</div>
                        </div>
                    </div>
                    ${customer?.note ? `
                        <details style="margin-top: 12px;">
                            <summary style="cursor: pointer; font-weight: 600; color: #495057; padding: 8px; background: white; border-radius: 6px;">üìã View Complete Patient Record & Consent Forms</summary>
                            <pre style="white-space: pre-wrap; margin-top: 12px; font-size: 13px; color: #495057; background: white; padding: 16px; border-radius: 6px; max-height: 500px; overflow-y: auto;">${customer.note}</pre>
                        </details>
                    ` : ''}
                `;

                container.appendChild(card);
            });
        }

        // Navigation
        function goToStep(stepId) {
            document.querySelectorAll('.step-content').forEach(step => {
                step.classList.add('hidden');
            });
            document.getElementById(stepId).classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateSteps(currentStep) {
            for (let i = 1; i <= 6; i++) {
                const step = document.getElementById(`step${i}`);
                if (i < currentStep) {
                    step.classList.add('completed');
                    step.classList.remove('active');
                } else if (i === currentStep) {
                    step.classList.add('active');
                    step.classList.remove('completed');
                } else {
                    step.classList.remove('active', 'completed');
                }
            }
        }
    </script>
</body>
</html>
